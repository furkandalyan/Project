{% extends "eys/base.html" %}

{% block content %}
<div style="display:flex; flex-direction:column; gap:18px;">
    <div style="background:linear-gradient(120deg,#0f5132,#1db954); color:white; border-radius:18px; padding:22px; box-shadow:0 22px 55px rgba(0,0,0,0.2);">
        <p style="margin:0; letter-spacing:0.08em; text-transform:uppercase; font-size:12px; opacity:0.85;">Ã–ÄŸrenci Paneli</p>
        <h1 style="margin:6px 0 4px 0;">Duyuru Kutum</h1>
        <p style="margin:0; opacity:0.8;">Duyuru merkezinden tÃ¼m mesajlarÄ± takip et.</p>
    </div>

    <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:15px; margin-bottom:10px;">
        <div style="display:flex; align-items:center; gap:12px;">
            <div style="color:#555; font-size:14px;">Toplam {{ total_count }} duyuru</div>
            {% if show_pinned_only %}
                <a href="?" style="color:#1db954; text-decoration:none; font-weight:600;">TÃ¼mÃ¼nÃ¼ GÃ¶ster</a>
            {% else %}
                <a href="?pinned=1" style="color:#1db954; text-decoration:none; font-weight:600;">Sadece Sabitler</a>
            {% endif %}
        </div>
    </div>

    <div style="display:grid; grid-template-columns:3fr 1fr; gap:22px;">
        <div style="background:white; border-radius:18px; padding:28px; box-shadow:0 20px 45px rgba(0,0,0,0.08);">
            {% if timeline %}
                <div style="position:relative; padding-left:25px;">
                    <div style="position:absolute; left:10px; top:0; bottom:0; width:2px; background:linear-gradient(180deg, #1db954, #bee9cd);"></div>
                    {% for group in timeline %}
                        <div style="margin-bottom:30px;">
                            <div style="margin-bottom:16px; font-weight:600; color:#1db954;">{{ group.date_label }}</div>
                            {% for item in group.items %}
                                <div style="display:flex; gap:15px; margin-bottom:18px;">
                                    <div style="width:42px; height:42px; border-radius:50%; background:#1db954; color:white; display:flex; align-items:center; justify-content:center; font-weight:600;">
                                        {{ item.author_initials }}
                                    </div>
                                    <div style="flex:1;">
                                        <div style="display:flex; justify-content:space-between; align-items:center; gap:10px;">
                                            <div>
                                                <h3 style="margin:0;">{{ item.title }}</h3>
                                                <p style="margin:4px 0; color:#666; font-size:13px;">{{ item.course_label }}</p>
                                            </div>
                                            <span style="color:#999; font-size:13px;">{{ item.timestamp }}</span>
                                        </div>
                                        <div style="background:#f8f8f8; padding:14px 16px; border-radius:12px; margin-top:10px;">
                                            <div style="margin:0; white-space:pre-line;">{{ item.body|safe }}</div>
                                            {% if item.attachment %}
                                                <a href="{{ item.attachment.url }}" target="_blank" style="display: inline-block; margin-top: 10px; font-size: 13px; color: #2459c3; text-decoration: none; font-weight: 600;">ğŸ“ Eki Ä°ndir</a>
                                            {% endif %}
                                        </div>
                                        <p style="margin:8px 0 0 0; color:#8a8a8a; font-size:13px;">GÃ¶nderen: {{ item.author_name }}</p>
                                        <a href="{% url 'announcement_detail' item.id %}" style="display: inline-block; margin-top: 10px; font-size: 13px; color: #1db954; text-decoration: none; font-weight: 600;">YorumlarÄ± GÃ¶r â†’</a>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div style="text-align:center; color:#a0a0a0; padding:60px 0;">
                    HenÃ¼z duyuru yayÄ±nlanmamÄ±ÅŸ. Ã–ÄŸretim elemanlarÄ±n mesaj paylaÅŸmaya baÅŸladÄ±ÄŸÄ±nda burada listelenecek.
                </div>
            {% endif %}
        </div>

        <div style="background:white; border-radius:18px; padding:24px; box-shadow:0 20px 45px rgba(0,0,0,0.08); position:sticky; top:20px; height:max-content;">
            <h3 style="margin-top:0;">HÄ±zlÄ± EriÅŸim</h3>
            <div style="display:flex; flex-direction:column; gap:12px;">
                <a href="{% url 'student_dashboard' %}"
                   style="padding:10px 14px; border-radius:10px; background:#f1fff6; color:#1db954; text-decoration:none; font-weight:600;">Dashboarda DÃ¶n</a>
                <a href="{% url 'student_courses' %}"
                   style="padding:10px 14px; border-radius:10px; border:1px solid #e6e6e6; text-decoration:none; color:#333;">Derslerim</a>
                <a href="{% url 'student_calendar' %}"
                   style="padding:10px 14px; border-radius:10px; border:1px solid #e6e6e6; text-decoration:none; color:#333;" target="_blank" rel="noopener noreferrer">Takvimim</a>
            </div>
            <hr style="margin:20px 0; border:none; border-top:1px solid #f0f0f0;">
            <p style="font-size:13px; color:#999;">Duyurular ders kodu ve Ã¶ÄŸretim elemanÄ±na gÃ¶re otomatik filtrelenir. Eski mesajlara aÅŸaÄŸÄ± kaydÄ±rarak ulaÅŸabilirsin.</p>
        </div>
    </div>
</div>
{% endblock %}
